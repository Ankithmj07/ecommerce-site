<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="shortcut icon" type="image/x-icon" href="\static\images\technology.png" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>


    <!--js bundle cdn-->
    

    <style>
        body{
            overflow: hidden;
        }
        .thumb{
            transition: transform 0.5s ease;
        }

        .thumb:hover{
            transform: scale(1.3); /* Increase the size of the image on hover */
            cursor: pointer;
        }

        .thumb.transformed{
            transform: scale(1.3) ;/* Make it larger when clicked*/
        }

        ::placeholder{
            color: #767676;
            font-size: 14px;
        }

        .anki:hover{
            cursor: pointer;
            background-color: #fafafa;
        }
        #searchBar{
            border: 1px #aaa7a7 solid;
            outline: none;
        }  
        
        #searchBar:focus {
            border: 3px solid #535659;
        }
        #Searchimg{
            cursor: pointer;
        }

        


    </style>
</head>
<body>
    <!--Navigation Start-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand">
                <img  src="\static\images\technology.png" style="width: 30px;"/><span style="margin-left: 10px;">GadgetsWave</span>
            </a>
            <div style="display: flex;justify-content: flex-end;">
                <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#searchModal">
                    <img style="width: 20px;margin-top: 10%;" src="\static\images\search-interface-symbol (1).png">
                </a>
                <a class="nav-link" href="/AdminLogin" style="color: white;margin-top: 3px;">
                    Admin
                </a>
                <a class="nav-link" href="#" id="myBag">
                    <img style="width: 20px;" src="\static\images\bag.png">
                </a>
                <a class="nav-link" href="#" id="myWishlist">
                    <img style="width: 20px;margin-top: 5px;" src="\static\images\heart.png">
                </a>
                <a href="#" style="margin-top: 3%;" class="dropdown-toggle" data-bs-toggle="dropdown">
                    <img style="width: 20px;margin-left: 40%;" src="\static\images\user.png">
                </a>
                <div class="dropdown-menu" style="margin-left:89%;">
                    <a href="#" style="font-size: 14px;" class="dropdown-item">Your Account</a>
                    <a href="#" style="font-size: 14px;" class="dropdown-item" id="myOrderButton">Your Orders</a>
                    <a href="#" style="font-size: 14px;" class="dropdown-item" id="logout">Logout</a>
                </div>
            </div>
        </div>

    </nav><br><br>
    <!--Navigation End-->

    <div class="container-fluid">
       

        <!--Product Display Grid Start-->
        <div class="row" id="productDetails">

            
        </div>
        <!--Product Display Grid End-->

    </div>

    <!--Add to cart popup start-->
    <div class="modal fade" id="addCart" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
    
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Product added to Cart Successfully</h4>
                    <!--<button type="button" class="close" data-dismiss="modal">&times;</button>-->
                </div>
    
                <!-- Modal body -->
                <div class="modal-body">
                    Your product has been added to the cart.
                </div>
    
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="goToCart()">Go to Cart</button>
                    <a href="#" onclick="closeDialog()" style="text-decoration: none;">Close</a>
                </div>
    
            </div>
        </div>
    </div>
    <!--Add to cart popup end-->
    <!--Login popup start-->
    <div class="modal fade" id="Login" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
    
                <!-- Modal Header -->
                <!-- Modal body -->
                <div class="modal-body" style="text-align: center;">
                    Please Login to Continue.
                </div>
    
                <!-- Modal footer -->
                <div class="modal-footer" style="display: flex;justify-content: center;">
                    <button type="button" class="btn btn-primary" onclick="Login()">Login</button>
                </div>
    
            </div>
        </div>
    </div>
    <!--Login popup end-->

    <!--search dialog start-->
    <div class="modal fade" id="searchModal" tabindex="-1">
        <div class="modal-dialog modal-lg" style="margin-top: 0;">
            <div class="modal-content" style="border-radius: 9px;">
                <div class="container">
                    <div class="row" style="margin-bottom: 1%;">
                        <input type="text" class="form-control" id="searchBar" placeholder="Search GadgetsWave.in" style="width:95%;height: 39px; border-radius: 9px 0px 0px 9px;">
                        <div onclick="searchInput();" style="background-color: #34383c;width: 39px;border-radius: 0px 9px 9px 0px;">
                            <img id="Searchimg" style="width: 18px;margin-top: 8px;" src="\static\images\search-interface-symbol (1).png">
                        </div>
                    </div>
                    <div id="searchRow">

                    </div>
                </div>
            </div>
        </div> 
    </div>
    <!--search dialog end-->

    <!--customer order popup start-->
    <!--<div class="modal fade" id="customerOrderPopup" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        Enter Shipping Details
                    </h5>
                </div>
                <div class="modal-body">
                    <p>
                        Please Enter Shipping Details Below
                    </p>
                    <p>
                        <label>Name</label>
                        <input type="text" class="form-control" id="name">
                        <span id="errMsgName" style="color: red;"></span>
                    </p>
                    <p>
                        <label>Email</label>
                        <input type="text" class="form-control" id="email">
                        <span id="errMsgEmail" style="color: red;"></span>
                    </p>
                    <p>
                        <label>Mobile</label>
                        <input type="text" class="form-control" id="mobile">
                        <span id="errMsgMobile" style="color: red;"></span>
                    </p>
                    <p>
                        <label>Shipping Address Line 1</label>
                        <input type="text" class="form-control" id="addr1">
                        <span id="errMsgAddr1" style="color: red;"></span>
                    </p>
                    <p>
                        <label>Shipping Address Line 2</label>
                        <input type="text" class="form-control">
                        <span id="errMsgAddr2" style="color: red;"></span>
                    </p>
                    <button class="btn btn-success" style="width: 100%;" onclick="validateShippingForm()">Place Order</button>
                </div>

            </div>
        </div>
    </div>-->
    <!--customer order popup end-->

    
    <script>

        var xhttpproductDetails=new XMLHttpRequest();
        xhttpproductDetails.onreadystatechange=function()
        {
            if(this.readyState==4 && this.status==200)     //200(Success), 300(Redirect), 400(server not found), 500(Internal server error)
            {
                console.log(this.responseText)
                var jsonData=JSON.parse(this.responseText)

                var productDetailsHTML=''

                productDetailsHTML+='<div class="col-1">'
                productDetailsHTML+=''+jsonData[0].product_thumbnails+''
                productDetailsHTML+='</div>'
                productDetailsHTML+='<div class="col-4">'
                productDetailsHTML+='<h3 style="margin-left: 120px;">Product Details</h3><br>'
                productDetailsHTML+='<div style="display: flex;justify-content: flex-end;">'
                productDetailsHTML+='<a href="#" onclick="share()"><img style="width:24px;" id="shareBtn" src="/static/images/share(1).png"/></a>'
                productDetailsHTML+='</div>'
            
                productDetailsHTML+='<div class="product-img">'
                productDetailsHTML+=''+jsonData[0].detailed_image+''
                productDetailsHTML+='</div>'
                
                productDetailsHTML+='</div>'
                productDetailsHTML+='<div style="font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,Cantarell, "Open Sans", "Helvetica Neue", sans-serif;" class="col-7">'

                productDetailsHTML+='<h2 style="margin-top: 50px;">'+jsonData[0].product_name+'</h2>'
                productDetailsHTML+='<p>'
                productDetailsHTML+=''+jsonData[0].product_description+''
                productDetailsHTML+='</p>'
                productDetailsHTML+='<p>'
                productDetailsHTML+='<h2 style="color: red;margin-left: 0px;">&#8377 '+jsonData[0].product_price+' <span style="text-decoration: line-through;font-size: 18px;color: black;">&#8377 '+jsonData[0].product_original_price+'</span><br></h2>'
                productDetailsHTML+='</p>'
                productDetailsHTML+='<p style="margin-left: 13px;">'
                productDetailsHTML+='<b>Key Features</b>'
            
                productDetailsHTML+=''+jsonData[0].product_key_features+''
                productDetailsHTML+='</p>'
    
                productDetailsHTML+='<div style="margin-top: 30px;" class="row">'
                productDetailsHTML+='<div class="col-3">'
                productDetailsHTML+='<button style="width: 68%;margin-left: 10px;font-size:15px;" class="btn btn-primary" onclick="BuyNow('+jsonData[0].id+');" data-bs-toggle="modal" id="buyNowButton">Buy Now</button>'
                productDetailsHTML+='</div>'
                productDetailsHTML+='<div class="col-9">'
                productDetailsHTML+='<button style="width: 20%;margin-left: 10px;background-color:#fb641b;font-size:15px;" type="button" class="btn btn-danger" data-bs-toggle="modal" onclick="getProductId('+jsonData[0].id+');" id="mycart">Add to Cart</button>'
                productDetailsHTML+='</div>'
                    
                productDetailsHTML+='</div>'

                productDetailsHTML+='</div>'

                    

            }

            document.getElementById('productDetails').innerHTML=productDetailsHTML
               
            var transformableImages = document.querySelectorAll('.thumb');
            var currentTransformedImage = null;

            transformableImages.forEach(function(image) {
                image.addEventListener('click', function() {
                    if (currentTransformedImage !== null) {
                        currentTransformedImage.classList.remove('transformed');
                    }
                    image.classList.add('transformed');
    
                    currentTransformedImage = image;
        });
    });


            /*const lens=document.querySelector('.magnifier-lens')
            const my_image=document.querySelector('.product-img img')
            const magnified_image=document.querySelector('.magnified-img')
            //console.log(my_image)

            function magnify(my_image,magnified_image){
                //lens.addEventListener('mousemove',moveLens)
                my_image.addEventListener('mousemove',moveLens)
            }

            function moveLens(e){

                //console.log("X : "+e.pageX+ "Y : "+e.pageY);

                let x,y,cx,cy;
                const product_image_rect=my_image.getBoundingClientRect();
                x=e.pageX ;
                y=e.pageY ;

                

                /*let max_xpos=product_image_rect.width - lens.offsetWidth;
                let max_ypos=product_image_rect.height - lens.offsetWidth;

                if(x > max_xpos) x=max_xpos;
                if(x < 0) x=0;


                if(y > max_ypos) x=max_ypos;
                if(y < 0) y=0;

                lens.style.cssText= `top: ${y}px; left: ${x}px`;

                cx = magnified_image.offsetWidth / lens.offsetWidth;
                cy = magnified_image.offsetHeight / lens.offsetHeight;


                magnified_image.style.cssText=`
                                        background: url('${my_image.src}')
                                        ${x * cx}px ${y * cy}px / ${product_image_rect.width * cx}px ${product_image_rect.height * cy}px 
                                        
                 `
            }



            magnify(my_image,magnified_image)*/
            

        }
        xhttpproductDetails.open("GET","http://127.0.0.1:8080/product-details",true)
        xhttpproductDetails.send()

        var searchRowHTML=''
        var nullHTML=''
        
        function searchInput(){
            

            var searchText=document.getElementById('searchBar').value
            var lastName=''
            console.log(searchText)
            
            var xhttpSearchProducts=new XMLHttpRequest
            xhttpSearchProducts.onreadystatechange=function(){
                if(this.readyState==4 && this.status==200){
                    console.log(this.responseText)
                    var jsonData=JSON.parse(this.responseText)
                    var jsonLength=jsonData.length
                    
                    if(this.responseText==0){
                        document.getElementById('searchRow').innerHTML=''
                    }
                    else{
                        for(var i=0;i<jsonLength;i++){
                            searchRowHTML+='<div class="row anki" style="width: 103%;text-align:start;">'
                            searchRowHTML+='<h5 onclick="viewProduct('+jsonData[i].id+')" style="font-size: 15px;font-weight: 400;">'+jsonData[i].p_name+'</h5>'
                            searchRowHTML+='</div>'
                            
                        }
                        lastName=searchText
                        

                        document.getElementById('searchRow').innerHTML=searchRowHTML
                    }
                
                    
                }
                
            }
            xhttpSearchProducts.open("POST","http://127.0.0.1:8080/search-products",true)
            xhttpSearchProducts.setRequestHeader("Content-type","application/x-www-form-urlencoded")
            xhttpSearchProducts.send('searchInput='+searchText)
            
        }

            var logoutButton=document.getElementById('logout')
            var myOrdersButton=document.getElementById('myOrderButton')
            var myBagButton=document.getElementById('myBag')
            var myWishlistButton=document.getElementById('myWishlist')

            var xhttpCustomerId=new XMLHttpRequest
            xhttpCustomerId.onreadystatechange=function(){
                if (this.readyState==4 && this.status==200)
                    {
                        console.log(this.responseText)
                        if(this.responseText==0){
                            document.getElementById('logout').innerHTML="Login"
                            logoutButton.addEventListener('click', Login);
                            myOrdersButton.addEventListener('click',Login);
                            myBagButton.addEventListener('click',Login)
                            myWishlistButton.addEventListener('click',Login)
                        }
                        else{
                            document.getElementById('logout').innerHTML="Logout"
                            logoutButton.addEventListener('click',Logout);
                            myOrdersButton.addEventListener('click',YourOrders);
                            myBagButton.addEventListener('click',myBag)
                            myWishlistButton.addEventListener('click',myWishlist)
                        }
                    }
                }
            xhttpCustomerId.open("GET","http://127.0.0.1:8080/customer-id",true)
            xhttpCustomerId.send()


            function Logout(){

                var xhttpLogout=new XMLHttpRequest
                xhttpLogout.onreadystatechange=function(){
                    if (this.readyState==4 && this.status==200)
                    {
                        console.log(this.responseText)
                        document.getElementById('logout').innerHTML="Login"
                    }
                
                }
                xhttpLogout.open("GET","http://127.0.0.1:8080/logout",true)
                xhttpLogout.send()
                window.location.reload()
            }


        function viewProduct(productId)
            {
                var xhttpproductClicks=new XMLHttpRequest();
                xhttpproductClicks.onreadystatechange=function()
                {
                    if(this.readyState==4 && this.status==200)     //200(Success), 300(Redirect), 400(server not found), 500(Internal server error)
                    {
                        console.log(this.responseText)
                        /*var jsonData=JSON.parse(this.responseText)
                        var otherPageUrl = jsonData.other_page_url
                        var data = jsonData.data;*/

                        window.location.href= '/trackProductClick/'+productId;
    
                    }
    
                }
                xhttpproductClicks.open("GET","http://127.0.0.1:8080/trackProductClick/"+productId,true)
                xhttpproductClicks.send()

                //window.location.href='product-details.html'
            
            }

            function Login(){
                window.location.href='/CustomerLogin'
            }
            
            function YourOrders(){
                window.location.href='/GotoOrders'
            }

            function myBag(){
                window.location.href='/goToCart'
            }

            function myWishlist(){
                window.location.href='/GoToWishlist'
            }



        /*function validateShippingForm(){
            var name = document.getElementById("name").value;

            if(name=='')
            {
                document.getElementById('errMsgName').innerHTML='Please Enter Name'
                return false
            }
            else{
                document.getElementById('errMsgName').innerHTML=''
            }
            var regxName=/^[A-Za-z. ]+$/
            var validName=name.match(regxName)

            if(!validName){
                document.getElementById('errMsgName').innerHTML='Please Enter Valid Name'
                return false
            }
            else{
                document.getElementById('errMsgName').innerHTML=''
            }

            // Read Value from Email textbox
            var email = document.getElementById("email").value;

            if(email=='')
            {
                document.getElementById('errMsgEmail').innerHTML='Please Enter Email'
                return false
            }
            else{
                document.getElementById('errMsgEmail').innerHTML=''
            }
            var regxEmail=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/
            var validEmail=email.match(regxEmail)
            if(!validEmail){
                document.getElementById('errMsgEmail').innerHTML='Please Enter Valid Email'
                return false
            }
            else{
                document.getElementById('errMsgEmail').innerHTML=''
            }


            // Read Value from Mobile Textbox
            var mobile = document.getElementById("mobile").value;

            if(mobile=='')
            {
                document.getElementById('errMsgMobile').innerHTML='Please Enter Mobile Number'
                return false
            }
            else{
                document.getElementById('errMsgMobile').innerHTML=''
            }

            var regxMobile=/^[6-9]\d{9}$/
            var validMobile=mobile.match(regxMobile)

            if(!validMobile){
                document.getElementById('errMsgMobile').innerHTML='Please Enter Valid Mobile'
                return false
            }
            else{
                document.getElementById('errMsgMobile').innerHTML=''
            }

            // Read value from Addr Textbox
            var addr1=document.getElementById('addr1').value
            if(addr1=='')
            {
                document.getElementById('errMsgAddr1').innerHTML='Please Enter the Address'
                return false
            }
            else{
                document.getElementById('errMsgAddr1').innerHTML=''
            }
            
            
            var regxAddr1=/^[A-Za-z0-9#@.-_,? ]+$/
            var validAddr1=addr1.match(regxAddr1)

            if(!validAddr1){
                document.getElementById('errMsgAddr1').innerHTML='Alphanumeric and #@.,-? are allowed'
                return false
            }
            else{
                document.getElementById('errMsgAddr1').innerHTML=''
                
            }
        }*/


         // AJAX code for Product Details


        

        function viewThumbnail1()
        {

            var thumb1=document.getElementById('img1').src
            document.getElementById('thumbNail').src=thumb1
            document.getElementById('thumbNail').style.marginTop='0px'
        }
        
        function viewThumbnail2()
        {

            var thumb2=document.getElementById('img2').src
            document.getElementById('thumbNail').src=thumb2
            document.getElementById('thumbNail').style.marginTop='0px'
        }

        function viewThumbnail3()
        {

            var thumb3=document.getElementById('img3').src
            document.getElementById('thumbNail').src=thumb3
            document.getElementById('thumbNail').style.marginTop='0px'
        }

        function viewThumbnail4()
        {

            var thumb4=document.getElementById('img4').src
            document.getElementById('thumbNail').src=thumb4
        }

        var imgElement = document.querySelectorAll('.thumb');

        imgElement.forEach(function(image) {
            image.addEventListener('mouseover', function() {
            // Apply hover effect
                image.style.transform = 'scale(1.3)';
                image.style.cursor = 'pointer';
            });

            image.addEventListener('mouseout', function() {
            // Revert to normal state
                image.style.transform = 'scale(1)';
                image.style.cursor = 'default';
            });
        });    


        

        function getProductId(p_id)
        {
            var AddToCartButton=document.getElementById('mycart')
            var xhttpCustomerId=new XMLHttpRequest
            xhttpCustomerId.onreadystatechange=function(){
                if(this.readyState==4 && this.status==200)
                {
                    console.log(this.responseText)

                    if(this.responseText==0){
                        AddToCartButton.setAttribute('data-bs-target','#Login')
                    }
                    else{
                        var xhttpproductCart=new XMLHttpRequest();
                        xhttpproductCart.onreadystatechange=function()
                            {
                                if(this.readyState==4 && this.status==200)     //200(Success), 300(Redirect), 400(server not found), 500(Internal server error)
                                {
                                    AddToCartButton.setAttribute('data-bs-target','#addCart')
                                }
                            
                            }
                        xhttpproductCart.open("GET","http://127.0.0.1:8080/insert-cart/"+p_id, true);
                        xhttpproductCart.send()
                    }
                }
            }
            xhttpCustomerId.open("GET","http://127.0.0.1:8080/customer-id", true)
            xhttpCustomerId.send()
        }
        
        function goToCart(){
            window.location.href='/goToCart';
        }

        function closeDialog(){
            $('#addCart').modal('hide');
        }

        function Login(){
            window.location.href='/CustomerLogin';
        }
        

        function BuyNow(product_id){

            var xhttpCustomerId=new XMLHttpRequest
            xhttpCustomerId.onreadystatechange=function(){
                if(this.readyState==4 && this.status==200)
                {
                    console.log(this.responseText)

                    if(this.responseText==0){
                        var buyButton=document.getElementById('buyNowButton')
                        buyButton.setAttribute('data-bs-target','#Login')

                    }
                    else{
                        var xhttpBuynow=new XMLHttpRequest();
                        xhttpBuynow.onreadystatechange=function()
                        {
                            if(this.readyState==4 && this.status==200)     //200(Success), 300(Redirect), 400(server not found), 500(Internal server error)
                            {
                                console.log(this.responseText)
                                window.location.href='/move-productid/'+product_id;
                            }
    
                        }
                        xhttpBuynow.open("GET","http://127.0.0.1:8080/move-productid/"+product_id, true);
                        xhttpBuynow.send()
                        
                    }
                    
                }
            }

            xhttpCustomerId.open("GET","http://127.0.0.1:8080/customer-id", true)
            xhttpCustomerId.send()

            
        }
        
    function share(){
        if (navigator.share) {
                navigator.share({
 
                    // Title that occurs over
                    // web share dialog
                    title: window.document.title,
 
                    // URL to share
                    url: window.document.location.href
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch(err => {
 
                    // Handle errors, if occurred
                    console.log(
                    "Error while using Web share API:");
                    console.log(err);
                });
            } else {
 
                // Alerts user if API not available 
                alert("Browser doesn't support this API !");
            }
        }


            

    </script>

</body>
</html>